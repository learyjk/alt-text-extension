(()=>{var b=setInterval(function(){let o=document.querySelectorAll('[data-automation-id="overlay"]');o.length>=2&&(m(o[1].parentNode),clearInterval(b))},250),m=o=>{let e={attributes:!0,childList:!0,subtree:!0,attributeFilter:["popover-asset"]},r=(v,S)=>{for(let l of v)if(l.type==="childList"&&l.addedNodes.length>0){let i=l.addedNodes[0];if(i?.attributes?.getNamedItem("data-automation-id")&&i?.querySelector('[data-automation-id="asset-details-popover"]')){let c=i.querySelector('[data-automation-id="asset-details-popover"]'),u=c?.querySelector('[data-automation-id="panel_asset_alt"]');if(!u){console.error("no alt text box found");return}let n=x(c);if(!n)return;let d=n.querySelector("span");if(!d)return;u.querySelector("textarea")?.parentNode?.append(n),n?.addEventListener("click",h=>{try{let s=c.querySelector("a")?.href;if(!s)throw new Error("no image src found!");let t=u.querySelector("textarea");if(!t)throw new Error("no alt text area found!");t.value="Please wait";let f=setInterval(()=>{t.value.length>=14?t.value="Please wait":t.value+="."},250);chrome.runtime.sendMessage({contentScriptQuery:"postData",data:JSON.stringify({urls:[s]}),url:"https://alt-text-generator-api-kcffb7uzra-uc.a.run.app/describe"},p=>{if(clearInterval(f),p!=null){let y=p.captions[0].description.captions[0].text;t.value=y}else throw t.value="No response. Please wait 60 seconds and try again.",new Error("No response. Please wait 60 seconds and try again.");t.focus();var g=new Event("change",{bubbles:!0,cancelable:!1});t.dispatchEvent(g)})}catch(s){console.error("error: ",s)}finally{d.innerHTML="AI Alt"}})}}};new MutationObserver(r).observe(o,e)},x=o=>{let e=o?.querySelector(".delete-asset")?.cloneNode(!0);if(!e){console.log("error getting delete asset");return}let r=e.querySelector("span");if(!r){console.log("error getting text");return}r.innerHTML="AI Alt",r.style.marginLeft="4px";let a=e.querySelector("i");if(!a){console.log("error gettig icon");return}return a.style.backgroundPositionY="-600px",a.style.backgroundPositionX="0px",e.style.position="absolute",e.style.left="0px",e.style.bottom="0px",e};})();
